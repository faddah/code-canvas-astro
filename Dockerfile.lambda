# Lambda-compatible Dockerfile
FROM public.ecr.aws/lambda/nodejs:20

# Copy package files
COPY package*.json ./

# Install production dependencies
RUN npm ci --omit=dev

# Copy built application
COPY dist ${LAMBDA_TASK_ROOT}/dist

# Copy lambda handler
COPY server/lambda.mjs ${LAMBDA_TASK_ROOT}/dist/server/

# Copy scripts if needed
COPY scripts ${LAMBDA_TASK_ROOT}/scripts

# Set the CMD to your handler
CMD [ "dist/server/lambda.handler" ]
